var Data=function(){function t(){}var e=(__define,t);e.prototype;return t.getRectWidth=function(){return 0==t._rectWidth&&(t._rectWidth=egret.MainContext.instance.stage.stageWidth/4),t._rectWidth},t.getRectRow=function(){return 0==t._rectRow&&(t._rectRow=Math.ceil(this.getStageHeight()/t.getRectWidth())+1),t._rectRow},t.getStageHeight=function(){return egret.MainContext.instance.stage.stageHeight},t._rectWidth=0,t.score=0,t._rectRow=0,t}();egret.registerClass(Data,"Data");var Game=function(){function t(t){this._root=t,this.createGroupRect(),this.createtimer(),this.showGameInfo()}var e=(__define,t),i=e.prototype;return i.showGameInfo=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this.gameInfo=new egret.TextField,this.gameInfo.width=t,this.gameInfo.height=300,this.gameInfo.background=!0,this.gameInfo.backgroundColor=0,this.gameInfo.y=(e-300)/2,this.gameInfo.verticalAlign=egret.VerticalAlign.MIDDLE,this.gameInfo.textAlign=egret.HorizontalAlign.CENTER,this.gameInfo.textColor=16777215,this.gameInfo.size=30,this.gameInfo.text="別踩白方塊\n\n(玩法: 從第二格開始點擊黑方塊，\n若點到白方塊或時間到則遊戲結束) \n\n 點擊這裡開始(Click here Start)\n\n DevelopBy Tom Yuan",this._root.addChild(this.gameInfo),this.gameInfo.touchEnabled=!0,this.gameInfo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},i.createGroupRect=function(){this._rectRoot=new egret.Sprite,this._root.addChild(this._rectRoot),this._rectGroups=[],this._row=Data.getRectRow();for(var t,e=0;e<this._row;e++)t=new GroupRect,t.addEventListener("gameOver",this.gameOver,this),t.addEventListener("clickRight",this.nextRow,this),this._rectGroups.push(t),t.y=Data.getRectWidth()*e,this._rectRoot.addChild(t);this._rectRoot.y=Data.getStageHeight()-this._rectRoot.height},i.nextRow=function(){for(var t=0;t<this._row;t++)this._rectGroups[t].move();Data.score++},i.gameOver=function(){this._timerPanel.stop(),this.GameOverPanel||(this.GameOverPanel=new GameOverPanel,this.GameOverPanel.addEventListener("startGame",this.startGame,this)),this._root.addChild(this.GameOverPanel)},i.createtimer=function(){this._timerPanel=new TimerPanel,this._timerPanel.addEventListener("gameOver",this.gameOver,this),this._root.addChild(this._timerPanel)},i.startGame=function(){Data.score=0,this.gameInfo.text="",this.gameInfo.background=!1;for(var t=0;t<this._row;t++)this._rectGroups[t].init(),this._rectGroups[t].y=Data.getRectWidth()*t,console.log(this._rectGroups[t].y),this._rectGroups[t]._currentRow=t,t!=this._row-1&&this._rectGroups[t].createBlackRect();this._timerPanel.start()},t}();egret.registerClass(Game,"Game");var GameApp=function(t){function e(){t.call(this),console.log("hello world!!!!"),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addStage,this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.addStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addStage,this);new Game(this)},e}(egret.DisplayObjectContainer);egret.registerClass(GameApp,"GameApp");var GameOverPanel=function(t){function e(){t.call(this),this.draw(),this.addEventListener(egret.Event.ADDED,this.showText,this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.draw=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this.graphics.beginFill(1118481,.5),this.graphics.drawRect(0,0,t,e),this.graphics.endFill(),this.txt=new egret.TextField,this.txt.width=t,this.txt.y=100,this.txt.textColor=16711680,this.txt.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.txt);var i=new egret.TextField;i.width=200,i.height=100,i.x=(t-200)/2,i.y=(e-100)/2,i.text="重新開始!!\n(Restart)",i.background=!0,i.backgroundColor=255,i.textColor=16777215,i.textAlign=egret.HorizontalAlign.CENTER,i.verticalAlign=egret.VerticalAlign.MIDDLE,this.addChild(i);var r=new egret.Sprite;r.graphics.beginFill(255),r.graphics.drawRect(0,0,200,100),r.graphics.endFill(),r.width=200,r.height=100,r.x=(t-200)/2,r.y=(e-100)/2,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},r.showText=function(){this.txt.text="我努力點擊了"+Data.score+"步",this.txt.size=30},r.startGame=function(){this.parent.removeChild(this),this.dispatchEventWith("startGame")},e}(egret.Sprite);egret.registerClass(GameOverPanel,"GameOverPanel");var GroupRect=function(t){function e(){t.call(this),this._currentRow=0,this._currentBlackRectindex=0,this.createRect()}__extends(e,t);var i=(__define,e),r=i.prototype;return r.createRect=function(){this._rects=[];for(var t=0;4>t;t++){var e=new Rect;this._rects.push(e),e.x=e.width*t,this.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickRect,this)}},r.onClickRect=function(t){t.target.onRectClick(),t.target.type==RectType.NONCLICKABLE||this._currentRow!=Data.getRectRow()-2?this.dispatchEventWith("gameOver"):this.dispatchEventWith("clickRight")},r.createBlackRect=function(){this.init();var t=Math.random();t>=0&&.25>t?this._currentBlackRectindex=0:t>=.25&&.5>t?this._currentBlackRectindex=1:t>=.5&&.75>t?this._currentBlackRectindex=2:t>=.75&&1>=t&&(this._currentBlackRectindex=3),this._rects[this._currentBlackRectindex].type=RectType.CLICKABLE},r.init=function(){for(var t=0;4>t;t++)this._rects[t].type=RectType.NONCLICKABLE},r.move=function(){this._currentRow++,this._currentRow==Data.getRectRow()&&(this._currentRow=0,this.createBlackRect()),this.y=this._currentRow*Data.getRectWidth()},e}(egret.Sprite);egret.registerClass(GroupRect,"GroupRect");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),r=i.prototype;return r.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},r.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),console.log("Hello world two")}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var Rect=function(t){function e(){t.call(this),this._colors=[0,16777215,16711680,255],this._current=1,this._type=RectType.NONCLICKABLE,this.touchEnabled=!0,this.draw()}__extends(e,t);var i=__define,r=e,n=r.prototype;return n.draw=function(){this.graphics.lineStyle(1,0),this.graphics.beginFill(this._colors[this._current]),this.graphics.drawRect(0,0,Data.getRectWidth(),Data.getRectWidth()),this.graphics.endFill()},i(n,"type",function(){return this._type},function(t){this._type=t,this._type==RectType.CLICKABLE?this._current=0:this._current=1,this.draw()}),n.onRectClick=function(){this._type==RectType.CLICKABLE?this._current=3:this._current=2,this.draw()},e}(egret.Sprite);egret.registerClass(Rect,"Rect");var RectType=function(){function t(){}var e=(__define,t);e.prototype;return t.CLICKABLE="clickable",t.NONCLICKABLE="nonclickable",t}();egret.registerClass(RectType,"RectType");var Test=function(t){function e(){function e(){i.text="測試，我叫tom",this.addChild(i)}t.call(this);var i=new egret.TextField;i.text="測試，大家好!!",i.y=300,this.addChild(i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,e,this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Sprite);egret.registerClass(Test,"Test");var TimerPanel=function(t){function e(){t.call(this),this._num=20,this._times=20,this.draw(),this.createTimer()}__extends(e,t);var i=(__define,e),r=i.prototype;return r.draw=function(){this.txt=new egret.TextField,this.txt.width=egret.MainContext.instance.stage.stageWidth,this.txt.y=100,this.txt.textColor=16711680,this.txt.textAlign=egret.HorizontalAlign.CENTER,this.txt.text="20'00''",this.addChild(this.txt)},r.createTimer=function(){this._timer=new egret.Timer(1e3,this._num),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimeCom,this)},r.onTimer=function(){this._times-=1,this.txt.text=this._times+"'00'"},r.onTimeCom=function(){this.txt.text="00'00''",this.dispatchEventWith("gameOver")},r.start=function(){this.txt.text="20'00''",this._times=20,this._timer.reset(),this._timer.start()},r.stop=function(){this._timer.stop(),this.txt.text=""},e}(egret.Sprite);egret.registerClass(TimerPanel,"TimerPanel");